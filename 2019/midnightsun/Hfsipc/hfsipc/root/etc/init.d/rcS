#!/bin/sh

find / -exec chown root: {} \;
find / -type d -exec chmod 0755 {} \;
find /bin /sbin /usr -type f -exec chmod 0755 {} \;
find /etc -type f -exec chmod 0644 {} \;
chown user: /home/user -R
chown root.root /root/*
chmod 440 /root/*
chmod 700 /root

mount -t devtmpfs none /dev
mount -t proc none /proc
mount -t sysfs none /sys

/sbin/mdev -s

insmod /hfsipc.ko
#chmod a+r /dev/hfs

HOME=/home/user; export HOME
ENV=$HOME/.profile; export ENV

echo ''
echo '                      Midnight Sun CTF presents...'
echo ''
echo ' ██░ ██   █████▒ ██████     ██▓ ██▓███   ▄████▄  '
echo '▓██░ ██▒▓██   ▒▒██    ▒    ▓██▒▓██░  ██▒▒██▀ ▀█  '
echo '▒██▀▀██░▒████ ░░ ▓██▄      ▒██▒▓██░ ██▓▒▒▓█    ▄ '
echo '░▓█ ░██ ░▓█▒  ░  ▒   ██▒   ░██░▒██▄█▓▒ ▒▒▓▓▄ ▄██▒'
echo '░▓█▒░██▓░▒█░   ▒██████▒▒   ░██░▒██▒ ░  ░▒ ▓███▀ ░'
echo ' ▒ ░░▒░▒ ▒ ░   ▒ ▒▓▒ ▒ ░   ░▓  ▒▓▒░ ░  ░░ ░▒ ▒  ░'
echo ' ▒ ░▒░ ░ ░     ░ ░▒  ░ ░    ▒ ░░▒ ░       ░  ▒   '
echo ' ░  ░░ ░ ░ ░   ░  ░  ░      ▒ ░░░       ░        '
echo ' ░  ░  ░             ░      ░           ░ ░      '
echo '                                        ░        '

setsid cttyhack setuidgid 1000 /bin/sh

echo -ne "\n"
echo "Game Over."

poweroff -f

